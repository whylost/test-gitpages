# This workflow will do a clean install of node dependencies, cache/restore them, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: Build Docs CI

on: # æ­¤CI/CDè§¦å‘æ—¶çš„äº‹ä»¶
  push: # åœ¨ä»£ç æäº¤æ—¶è‡ªåŠ¨è§¦å‘
    branches:
      - master
      
# ä¸€ä¸ª CI/CD çš„å·¥ä½œæµæœ‰è®¸å¤š jobs ç»„æˆï¼Œæ¯”å¦‚æœ€å…¸å‹çš„ job æ˜¯ lintï¼Œtestï¼Œbuildã€‚
jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [14, 16]
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Install pnpm
        uses: pnpm/action-setup@v2.0.1
        with:
          version: 6.15.1

      - name: Set node version to ${{ matrix.node_version }}
        uses: actions/setup-node@v2
        with:
          node-version: ${{ matrix.node_version }}
          cache: "pnpm"

      - name: Install deps
        run: pnpm install

      - name: Build ğŸ”§
        run: pnpm run build
        
      - name: Deploy ğŸš€
        uses: JamesIves/github-pages-deploy-action@releases/v3
        with:
          ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}
          BRANCH: gh-pages
          FOLDER: "./docs/.vitepress/dist/"
